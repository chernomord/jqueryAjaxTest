function getDevices(e){var n=$.Deferred();return $.ajax(e).done(function(e){n.resolve(e)}).fail(n.reject),n.promise()}function load(){console.log("populating ...");var e=getDevices(devicesConf).done(function(e){$devices=e,$(".table").droppable({drop:function(e,n){var o=$(n.helper).clone(!1).removeClass("ui-draggable-dragging");$(this).append(o.draggable().selectable()),$(".element__del").click(function(){$(this).parent().remove()})}});var n=getTypes($devices);renderElements($devices,n)});$.when(e).done(console.log("populating : done"))}function getTypes(e){function n(e){var n={};return e.filter(function(e){return n.hasOwnProperty(e)?!1:n[e]=!0})}var o=e.map(function(e,n){return e.type});return n(o)}function renderElements(e,n){for(i=0;i<n.length;i++){var o=function(e,o){return e.type==n[i]?!0:void 0},t=e.filter(o);$("div.elements__box").append('<div class="element " id="'+n[i]+'">'+n[i].replace("_"," ")+'<div class="element__counter">'+t.length+"</div></div>"),$(".element#"+n[i]).data(t).draggable({helper:"clone",revert:"invalid",start:function(e,n){return console.log($devices),n.helper.children("div").css("display","none").parent().addClass("element--inst").append('<span class="element__del">x</span>')}})}console.log($(".element#media_player").data()[2])}var devicesConf={url:"devices.json",type:"GET",dataType:"json",success:function(e){return e},error:function(e,n,o){alert("Sorry, there was a problem!"),console.log("Error: "+o),console.log("Status: "+n)},complete:function(e,n){console.log("conf: devices.json loaded")}};$(document).ready(function(){load()}).bind().ajaxStart(function(){$("#loading").show()}).ajaxStop(function(){$("#loading").hide()});